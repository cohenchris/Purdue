# CS426 Lab 4 - Kaminsky Attack - DNS Cache Poisoning

## FILES

#### attacktask4.py
- This file sends a test DNS query to our local DNS server.
- Invoking it will make the local DNS server send a DNS query to authoritative nameservers in response
- To run this file, execute `sudo ./attacktask4.py`

#### attacktask5.py
- This file sends a spoofed DNS response to our local DNS server.
- Invoking it will send a reply to the local DNS server with our malicious nameserver hosted on the attacker VM.
- The goal is to make the local DNS server that the reply is legitimate, caching the malicious nameserver.
- To run this file, execute `sudo ./attacktask5.py`

#### check_cache.sh
- This file is used to dump and check the DNS cache on our local DNS server.

#### generate_dns_request.py
- This file is used to generate a DNS request packet for use in attack.c.
- To run this program, execute `./generate_dns_request.py`.
- The DNS request packet template is outputted in `ip_req.bin`.

#### generate_dns_reply.py
- This file is used to generate a DNS reply packet for use in attack.c.
- To run this program, execute `./generate_dns_reply.py`.
- The DNS reply packet template is outputted in `ip_resp.bin`.

#### attack.c
- This file executes our full attack.
- It uses our request/response templates generated by generate_dns_reply.py and generate_dns_request.py
- In short, we send a DNS query to the local DNS server, and send 1000 spoofed replies (500 from each of example.com's nameservers).
- If the spoofed reply's transaction token is guessed correctly, the local DNS server accepts and caches our fake nameserver, poisoning the cache.
- The next time that a user queries the local DNS server for example.com, it will use our ns.cohen50.com nameserver, hosted on the attacker VM.
- Compile this file by running `gcc attack.c -o attack`
- Run this file by executing `sudo ./attack`
